---
phase: 05.2-seo-improvements-and-layout-restructuring
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - lib/constants.ts
  - app/layout.tsx
autonomous: true

must_haves:
  truths:
    - "Page title includes dynamic year in Bulgarian"
    - "Meta description includes dynamic year in Bulgarian"
    - "All repeated text strings are defined in a single constants file"
    - "Constants are type-safe with TypeScript const assertion"
  artifacts:
    - path: "lib/constants.ts"
      provides: "Shared text constants for page title, meta description, subtitle, legend labels"
      exports: ["PAGE_TITLE", "META_DESCRIPTION", "PAGE_SUBTITLE", "PAGE_DESCRIPTION", "LEGEND_LABELS"]
    - path: "app/layout.tsx"
      provides: "Dynamic SEO metadata using generateMetadata"
      contains: "generateMetadata"
  key_links:
    - from: "app/layout.tsx"
      to: "lib/constants.ts"
      via: "import PAGE_TITLE, META_DESCRIPTION"
      pattern: "import.*constants"
---

<objective>
Create a shared constants file for all repeated Bulgarian text and update layout.tsx to use dynamic year-based SEO metadata.

Purpose: Extract all duplicated text strings to a single source of truth, making text changes safe and enabling tests to reference the same constants. Fix hardcoded "2026" in SEO metadata.

Output: `lib/constants.ts` with all shared text, `app/layout.tsx` with `generateMetadata` function using dynamic year.
</objective>

<execution_context>
@/home/nikolaymih11/.claude/get-shit-done/workflows/execute-plan.md
@/home/nikolaymih11/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05.2-seo-improvements-and-layout-restructuring/05.2-CONTEXT.md
@app/layout.tsx
@app/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared constants file</name>
  <files>lib/constants.ts</files>
  <action>
  Create `lib/constants.ts` with the following exports:

  ```typescript
  export const PAGE_TITLE = (year: number) =>
    `Празнични, неучебни и неработни дни през ${year} година`;

  export const META_DESCRIPTION = (year: number) =>
    `Запознайте се с официалните празници, неучебните и неработните дни за ${year} година. Разберете кога се падат почивните дни и как най-ефективно да комбинирате отпуск с празници за по-дълги почивки.`;

  export const PAGE_SUBTITLE = 'Календар с български празници и работни дни за планиране на вашата година.';

  export const PAGE_DESCRIPTION = 'Запознайте се с официалните празници, неучебните и неработните дни. Разберете кога се падат почивните дни и как най-ефективно да комбинирате отпуск с празници за по-дълги почивки.';

  export const LEGEND_LABELS = {
    OFFICIAL_HOLIDAY: 'Официален празник',
    WEEKEND: 'Уикенд',
    TODAY: 'Днес',
    VACATION: 'Лична почивка',
    BRIDGE: 'Предложение за почивка',
    SCHOOL_HOLIDAY: 'Неучебни дни / Ученически ваканции',
  } as const;

  export const APP_NAME = 'Почивни Работни Дни';
  export const APP_SHORT_NAME = 'Почивни Дни';
  ```

  Use `as const` where appropriate for type safety. Use function signatures for dynamic year content. Do NOT use a nested object structure - use flat named exports for tree-shaking.
  </action>
  <verify>TypeScript compilation succeeds: `npx tsc --noEmit lib/constants.ts`</verify>
  <done>lib/constants.ts exists with all text constants exported as named exports, including PAGE_TITLE and META_DESCRIPTION as functions accepting year parameter</done>
</task>

<task type="auto">
  <name>Task 2: Update layout.tsx with dynamic SEO metadata</name>
  <files>app/layout.tsx</files>
  <action>
  Replace the static `metadata` export in `app/layout.tsx` with a `generateMetadata` function that uses dynamic year.

  1. Import `getYear` from `date-fns` and import `PAGE_TITLE`, `META_DESCRIPTION`, `APP_SHORT_NAME` from `@/lib/constants`
  2. Replace `export const metadata: Metadata` with:
  ```typescript
  export function generateMetadata(): Metadata {
    const year = getYear(new Date());
    return {
      title: `${APP_NAME} - ${PAGE_TITLE(year)}`,
      description: META_DESCRIPTION(year),
      manifest: "/manifest.json",
      themeColor: "#C68E17",
      appleWebApp: {
        capable: true,
        statusBarStyle: "default",
        title: APP_SHORT_NAME,
      },
    };
  }
  ```
  3. Keep all other layout.tsx code unchanged (Nunito font, AuthProvider, Toaster, NetworkStatus, ServiceWorkerRegistration)
  4. Do NOT touch the body/children structure

  IMPORTANT: `generateMetadata` is a Next.js convention - it must be a named export function (not arrow function) for Next.js to recognize it.
  </action>
  <verify>Run `npm run build` or `npx next build` to verify no build errors. Check that the function is correctly exported.</verify>
  <done>layout.tsx uses generateMetadata with dynamic year from date-fns, importing constants from lib/constants.ts</done>
</task>

</tasks>

<verification>
1. `lib/constants.ts` exists and exports all required constants
2. `app/layout.tsx` uses `generateMetadata` function instead of static `metadata` export
3. Year is dynamic (calculated from current date, not hardcoded)
4. Build succeeds without errors
5. All existing layout functionality preserved (font, providers, etc.)
</verification>

<success_criteria>
- Shared constants file exists at lib/constants.ts
- All text that appears in multiple places has a single source of truth
- SEO metadata uses dynamic year
- No hardcoded "2026" in metadata
- TypeScript compilation passes
</success_criteria>

<output>
After completion, create `.planning/phases/05.2-seo-improvements-and-layout-restructuring/05.2-01-SUMMARY.md`
</output>
