---
phase: 05.2-seo-improvements-and-layout-restructuring
plan: 05
type: execute
wave: 2
depends_on: ["05.2-02"]
files_modified:
  - components/LeftSidebar.tsx
autonomous: true

must_haves:
  truths:
    - "Left sidebar displays official holidays in format: date + year + name"
    - "Left sidebar displays school vacations in format: date range + name"
    - "Official holidays section appears first, school vacations section below"
    - "Holidays sorted by date within each section"
    - "Holiday dates shown in Bulgarian format (e.g., 1 Януари 2026)"
    - "School vacation dates shown as ranges (e.g., 4 Април - 13 Април)"
  artifacts:
    - path: "components/LeftSidebar.tsx"
      provides: "Left sidebar component with holiday list and school vacations"
      exports: ["default"]
  key_links:
    - from: "components/LeftSidebar.tsx"
      to: "lib/holidays/types.ts"
      via: "import Holiday, SchoolHoliday"
      pattern: "import.*Holiday.*SchoolHoliday"
---

<objective>
Create the LeftSidebar component that displays official holidays and school vacation periods.

Purpose: Provide a quick-reference list of holidays and school vacations, especially important on mobile where tooltips are disabled. This gives users an alternative way to see holiday information without interacting with calendar cells.

Output: `components/LeftSidebar.tsx` - a server-compatible component that renders two sections: official holidays list and school vacation periods.
</objective>

<execution_context>
@/home/nikolaymih11/.claude/get-shit-done/workflows/execute-plan.md
@/home/nikolaymih11/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/05.2-seo-improvements-and-layout-restructuring/05.2-CONTEXT.md
@.planning/phases/05.2-seo-improvements-and-layout-restructuring/05.2-RESEARCH.md
@lib/holidays/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create LeftSidebar component</name>
  <files>components/LeftSidebar.tsx</files>
  <action>
  Create `components/LeftSidebar.tsx` as a component (NOT 'use client' - keep as Server Component if possible, but may need 'use client' if it's rendered inside a client component tree).

  Since LeftSidebar will be rendered inside page.tsx which passes data as props (holidays fetched server-side), it should receive data via props rather than fetching itself.

  **Props:**
  ```typescript
  import { format, parseISO } from 'date-fns';
  import { bg } from 'date-fns/locale';
  import type { Holiday } from '@/lib/holidays/types';
  import type { SchoolHoliday } from '@/lib/holidays/types';

  interface LeftSidebarProps {
    holidays: Holiday[];
    schoolHolidays: SchoolHoliday[];
    year: number;
  }
  ```

  **Component Structure:**
  ```tsx
  export default function LeftSidebar({ holidays, schoolHolidays, year }: LeftSidebarProps) {
    // Filter holidays for the current year only
    const yearHolidays = holidays
      .filter(h => h.date.startsWith(`${year}-`))
      .sort((a, b) => a.date.localeCompare(b.date));

    // Filter school holidays for the current year
    const yearSchoolHolidays = schoolHolidays
      .filter(sh => sh.startDate.startsWith(`${year}-`) || sh.endDate.startsWith(`${year}-`))
      .sort((a, b) => a.startDate.localeCompare(b.startDate));

    return (
      <div className="border rounded-lg p-4 bg-white">
        {/* Official Holidays Section */}
        <h3 className="font-semibold text-espresso mb-3">Официални празници</h3>
        <ul className="space-y-2 mb-6">
          {yearHolidays.map((holiday) => {
            const date = parseISO(holiday.date);
            const formattedDate = format(date, 'd MMMM', { locale: bg });
            // Capitalize month name
            const parts = formattedDate.split(' ');
            const capitalizedDate = parts.length >= 2
              ? `${parts[0]} ${parts[1].charAt(0).toUpperCase()}${parts[1].slice(1)}`
              : formattedDate;

            return (
              <li key={holiday.date} className="flex items-start gap-2 text-sm">
                <div className="w-2 h-2 rounded-full bg-cinnamon mt-1.5 flex-shrink-0" />
                <span className="text-coffee">
                  <span className="font-medium text-espresso">{capitalizedDate} {year}</span>
                  {' – '}
                  {holiday.name}
                </span>
              </li>
            );
          })}
        </ul>

        {/* School Vacations Section */}
        {yearSchoolHolidays.length > 0 && (
          <>
            <h3 className="font-semibold text-espresso mb-3">Ученически ваканции</h3>
            <ul className="space-y-2">
              {yearSchoolHolidays.map((schoolHoliday, index) => {
                const startDate = parseISO(schoolHoliday.startDate);
                const endDate = parseISO(schoolHoliday.endDate);

                const startFormatted = format(startDate, 'd MMMM', { locale: bg });
                const endFormatted = format(endDate, 'd MMMM', { locale: bg });

                // Capitalize month names
                const capitalizeMonth = (str: string) => {
                  const parts = str.split(' ');
                  return parts.length >= 2
                    ? `${parts[0]} ${parts[1].charAt(0).toUpperCase()}${parts[1].slice(1)}`
                    : str;
                };

                const displayName = schoolHoliday.gradeLevel
                  ? `${schoolHoliday.name} (${schoolHoliday.gradeLevel})`
                  : schoolHoliday.name;

                return (
                  <li key={`${schoolHoliday.startDate}-${index}`} className="flex items-start gap-2 text-sm">
                    <div className="w-2 h-2 rounded-full bg-teal mt-1.5 flex-shrink-0" />
                    <span className="text-coffee">
                      <span className="font-medium text-espresso">
                        {capitalizeMonth(startFormatted)} – {capitalizeMonth(endFormatted)}
                      </span>
                      {' – '}
                      {displayName}
                    </span>
                  </li>
                );
              })}
            </ul>
          </>
        )}
      </div>
    );
  }
  ```

  Key design decisions:
  - Uses parseISO for date parsing (Safari-safe per TECH-07)
  - Bulgarian date formatting with bg locale from date-fns
  - Month names capitalized (Bulgarian convention)
  - Official holidays: cinnamon dot indicator, format "1 Януари 2026 – Нова година"
  - School vacations: teal dot indicator, format "4 Април – 13 Април – Пролетна ваканция"
  - Grade level shown in parentheses when available
  - Sorted by date within each section
  - Clean Coffee theme styling with consistent text hierarchy
  - No 'use client' directive unless required by parent component context
  </action>
  <verify>
  1. TypeScript compilation succeeds: `npx tsc --noEmit components/LeftSidebar.tsx`
  2. Component can be imported without errors
  3. Build succeeds: `npm run build`
  </verify>
  <done>
  LeftSidebar component exists at components/LeftSidebar.tsx with:
  - Official holidays list with cinnamon dot, date + year + name format
  - School vacations list with teal dot, date range + name format
  - Bulgarian date formatting using date-fns bg locale
  - Proper sorting by date within each section
  - Grade level info shown when available
  </done>
</task>

</tasks>

<verification>
1. `components/LeftSidebar.tsx` exists and exports default component
2. Component accepts `holidays`, `schoolHolidays`, and `year` props
3. Official holidays show in format: "1 Януари 2026 – Нова година"
4. School vacations show in format: "4 Април – 13 Април – Пролетна ваканция"
5. Sections are clearly separated
6. Dates use parseISO (not new Date(string))
7. Build succeeds
</verification>

<success_criteria>
- Left sidebar component renders holiday list and school vacation list
- Date formatting is Bulgarian and uses date-fns safely
- Visual design uses Coffee theme tokens
- Component is ready to be placed in page layout (Plan 06)
</success_criteria>

<output>
After completion, create `.planning/phases/05.2-seo-improvements-and-layout-restructuring/05.2-05-SUMMARY.md`
</output>
