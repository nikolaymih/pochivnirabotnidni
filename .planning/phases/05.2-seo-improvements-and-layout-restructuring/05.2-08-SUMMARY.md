# Phase 5.2 Plan 08: School Holiday Filtering, Weekend Holidays, Split-Cell Overlap

**One-liner:** Filter summer vacation and weekends from school holidays, show holidays on weekends, split-cell gradient for bridge+school overlap.

## Changes Made

### Task 1: schoolHolidays.ts - Filtering Improvements

**1a. Exclude summer vacation ("Лятна ваканция"):**
- Added filter after deduplication to remove entries containing "Лятна ваканция"
- Rationale: Too long (3 months), too static, clutters the calendar per UAT feedback
- Updated console.log and return to use `filtered` instead of `deduplicated`

**1b. Filter weekends from school holiday dates:**
- Added `getISODay` to date-fns imports
- Modified `getSchoolHolidayDates()` to skip Saturday (6) and Sunday (7)
- Only weekdays (Mon-Fri, isoDay 1-5) are added to the school holiday date set
- Rationale: School holidays only matter on school days (weekdays)

### Task 2: MonthGrid.tsx - Visual Fixes

**2a. Show holidays on weekends (T10 fix):**
- Changed `showAsHoliday = isHoliday && !isWeekendHoliday` to `showAsHoliday = isHoliday`
- Weekend holidays now display with cinnamon background on the actual weekend day
- Transfer-to-Monday logic still works (Monday still gets transferred holiday if not already a holiday)
- `isWeekendHoliday` variable kept for potential future use

**2b. Split-cell rendering for bridge+school overlap (T9 fix):**
- Added `isBridgeSchoolOverlap` computed variable after `displayAsHoliday`
- Condition: `isBridge && isSchoolHoliday && !displayAsHoliday && !isVacation`
- Added `!isBridgeSchoolOverlap` guard to school holiday and bridge day class conditions
- Added `text-espresso` class for overlap cells
- Changed `style` prop from simple conditional to object spread supporting both gridColumnStart and linear-gradient
- Split-cell uses `linear-gradient(135deg, var(--color-bridge-bg) 50%, var(--color-school-bg) 50%)`

## Files Modified

| File | Changes |
|------|---------|
| `lib/holidays/schoolHolidays.ts` | Added getISODay import, Лятна ваканция filter, weekday-only school holiday dates |
| `components/MonthGrid.tsx` | showAsHoliday fix, isBridgeSchoolOverlap variable, split-cell gradient, updated dayClasses |

## Verification

- [x] `npm run build` passes with no errors
- [x] `getISODay` imported in schoolHolidays.ts
- [x] Лятна ваканция filtered out
- [x] `showAsHoliday = isHoliday` (no `!isWeekendHoliday`)
- [x] `linear-gradient` for split-cell present
- [x] `isBridgeSchoolOverlap` variable defined and used

## Deviations from Plan

None - plan executed exactly as written.

## Decisions Made

| ID | Decision | Rationale |
|----|----------|-----------|
| D1 | Keep isWeekendHoliday variable despite removing from showAsHoliday | No dead code harm, may be useful for future conditional logic |
| D2 | Split-cell gradient at 135deg diagonal | Visually distinguishes from both solid school and solid bridge cells |

## Duration

~1 minute
