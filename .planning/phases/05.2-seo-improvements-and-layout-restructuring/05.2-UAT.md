---
status: diagnosed
phase: 05.2-seo-improvements-and-layout-restructuring
source: 05.2-01-SUMMARY.md, 05.2-02-SUMMARY.md, 05.2-03-SUMMARY.md, 05.2-04-SUMMARY.md, 05.2-05-SUMMARY.md, 05.2-06-PLAN.md
started: 2026-02-08T10:00:00Z
updated: 2026-02-08T12:30:00Z
---

## Current Test
<!-- OVERWRITE each test - shows where we are -->

[testing complete]

## Tests

### 1. Dynamic SEO Page Title
expected: Browser tab shows dynamic Bulgarian title with current year (2026). Not hardcoded — if you change URL to /?year=2025, the tab title should still reference the app (metadata is layout-level, year in title).
result: issue
reported: "does not pass - title is still being in the header. It should not stay in the main component on top of the calendar select year"
severity: major

### 2. Three-Column Desktop Layout
expected: On desktop (wide screen), the page shows three columns: left sidebar (holidays list) | center (calendar) | right sidebar (legend + vacation summary). Header above with title and auth button only.
result: issue
reported: "Multiple issues: (1) Left sidebar should be TWO separate cards - 'Официални празници' and 'Ученически ваканции' - not one combined section. (2) No scrollbar on sidebars - should use sticky scroll behavior like the right sidebar. (3) Cards need box-shadow and same background styling as Легенда card. (4) Whole layout is wrong - columns should be brought together with margin:0 auto and shrink on smaller screens. See wireframe: https://iili.io/fmvraZg.png"
severity: major

### 3. Mobile Stacked Layout
expected: On mobile width (resize browser narrow or use dev tools), layout stacks vertically: title/description at top, then legend + vacation summary, then left sidebar (holidays list), then year selector + calendar at bottom.
result: pass

### 4. Left Sidebar - Official Holidays
expected: Left sidebar shows a list of official Bulgarian holidays for the year. Each entry has a cinnamon dot indicator, a date in Bulgarian format (e.g., "1 Януари 2026"), and the holiday name (e.g., "Нова година").
result: pass

### 5. Left Sidebar - School Vacations
expected: Left sidebar shows school vacation periods below official holidays. Each entry has a teal dot indicator and shows date ranges in Bulgarian (e.g., "4 Април – 13 Април – Пролетна ваканция").
result: pass

### 6. Year Selector Navigation
expected: Above the calendar, there are left/right arrows with the current year (2026) displayed between them. Clicking an arrow changes the URL (e.g., /?year=2025) and reloads the page with that year's data. The calendar, holidays, and sidebar all update.
result: pass
note: "User concern (future work): When viewing past or future years, vacation marking and Лична почивка editing should be disabled — calendar interaction and Общо дни за отпуск editing only make sense for current year."

### 7. Legend Shows All 6 Day Types
expected: The legend displays 6 entries in this order: Официален празник (cinnamon), Неучебни дни (teal), Предложение за почивка (honey/yellow), Лична почивка (caramel), Уикенд (cream), Днес (today indicator). The holiday swatch shows solid dark cinnamon with white "П" text.
result: issue
reported: "(1) Remove the 'П' text from the holiday legend swatch - was never requested. (2) Лична почивка and Предложение за почивка colors are too similar, hard to differentiate. Лична почивка needs to be brighter/more saturated — same brightness level as Официален празник (cinnamon). Applies to both legend AND calendar cells."
severity: major

### 8. Holiday Cells - Solid Cinnamon Color
expected: Official holidays in the calendar display as solid dark cinnamon/brown background with white text. They should match the legend swatch appearance — not a light background.
result: pass

### 9. School Holidays in Calendar - Teal Display
expected: School vacation days in the calendar show with a light teal background and teal border. These should be visually distinct from holidays (cinnamon) and bridge days (honey/yellow).
result: issue
reported: "UX looks good but: (1) School holidays should NOT display on Saturday/Sunday — weekdays only. (2) Skip 'Лятна ваканция' (16 May – 14 Sep) entirely — too long, too static, skip for every year. (3) When Предложение за почивка and Ученически ваканции overlap on same cell, split the cell in two halves — each half colored with its respective day type color."
severity: major

### 10. Weekend Holiday Transfer to Monday
expected: If a holiday falls on Saturday or Sunday, that weekend day shows as a regular weekend (no holiday color). Instead, the following Monday displays as a holiday with cinnamon color. Hovering over that Monday on desktop should show the holiday name with "(почивен ден)" suffix.
result: issue
reported: "Works correctly as implemented, but user changed mind: wants holidays shown on BOTH the weekend day AND the transferred Monday. Both should have cinnamon color and tooltip. Revert hiding holidays on weekends."
severity: major

### 11. Desktop-Only Tooltips
expected: On desktop, hovering over a holiday cell shows a tooltip with the holiday name and date. On mobile (or narrow width), tooltips do NOT appear — tapping holiday cells should NOT trigger any tooltip popup that would interfere with drag selection.
result: issue
reported: "Works as implemented but user changed mind: on mobile, show a small exclamation mark icon at top-right corner of holiday cells. Tapping (click, not hover) the icon toggles the tooltip. This way tooltip doesn't interfere with drag selection but holiday info is still accessible on mobile."
severity: minor

### 12. Calendar Dimensions Bounded
expected: Each month in the calendar has a maximum width of about 650px and doesn't grow excessively wide on large screens. The calendar maintains a compact appearance suitable for viewing all 12 months.
result: pass
note: "User request (future/gap): On mobile, all sections (Легенда, Лична почивка, sidebars) should match the same width as the calendar. Add a wrapper so everything below the header fits the same width — only header stays full-width."

### 13. Sticky Sidebars on Desktop
expected: On desktop, both left and right sidebars stay visible (sticky) while scrolling through the 12-month calendar. They should not scroll away as you scroll down through the months.
result: pass
note: "Sticky works but left sidebar has a scrollbar — already captured in Test 2 issue: left sidebar should be two separate cards with same overflow/scroll behavior as right sidebar (no internal scrollbar)."

### 14. Vacation Drag Selection Still Works
expected: You can still click/drag to select vacation days on the calendar. Selected days show in caramel color. The vacation summary updates with used/remaining days. Drag selection works on both desktop and mobile.
result: pass

### 15. Vacation + School Holiday Overlap Indicator
expected: If you mark a vacation day that falls within a school holiday period, the cell shows vacation color (caramel) with a small teal dot indicator in the corner, showing both day types overlap.
result: pass

## Summary

total: 15
passed: 9
issues: 6
pending: 0
skipped: 0

## Gaps

- truth: "Page title should only be in browser tab (SEO metadata), not displayed visually in the header or above the calendar/year selector"
  status: failed
  reason: "User reported: title is still being in the header. It should not stay in the main component on top of the calendar select year"
  severity: major
  test: 1
  root_cause: "page.tsx renders PAGE_TITLE(currentYear) as <h1> in both mobile (line 44) and desktop (line 75) layouts. Should be metadata-only."
  artifacts:
    - path: "app/page.tsx"
      issue: "Lines 44, 75: <h1> elements render PAGE_TITLE visually"
  missing:
    - "Remove <h1> title elements from both mobile and desktop layouts in page.tsx"
    - "Keep PAGE_SUBTITLE (description text) if desired, or remove too"

- truth: "Three-column layout: left sidebar (2 separate cards for holidays + school vacations), center calendar, right sidebar (legend + vacation). Columns tight together, centered, shrinking on small screens. Cards styled like Легенда with box-shadow. No scrollbar on sidebars — sticky scroll."
  status: failed
  reason: "User reported: (1) Left sidebar should be TWO separate cards not one combined section. (2) No scrollbar - sticky scroll like right sidebar. (3) Cards need box-shadow and same bg as Легенда. (4) Layout wrong - columns should be margin:0 auto and shrink on smaller screens. See wireframe."
  severity: major
  test: 2
  root_cause: "LeftSidebar.tsx is one single <div> container with both sections. page.tsx line 85 wraps it with overflow-y-auto causing scrollbar. Three-column flex (line 82) lacks mx-auto/max-width centering."
  artifacts:
    - path: "components/LeftSidebar.tsx"
      issue: "Single card structure, missing box-shadow, needs split into two separate cards"
    - path: "app/page.tsx"
      issue: "Lines 82-107: flex container lacks mx-auto/max-width; line 85 overflow-y-auto causes scrollbar"
  missing:
    - "Split LeftSidebar into two separate card divs with mt-4 between them"
    - "Add shadow-sm and border-latte to match Legend/VacationSummary styling"
    - "Remove overflow-y-auto from left sidebar wrapper in page.tsx"
    - "Add mx-auto max-w-[...] to three-column flex container for centering"
    - "Make sidebar widths responsive (shrink on medium screens)"

- truth: "Legend swatches correct: no 'П' text in holiday swatch, and Лична почивка color clearly distinguishable from Предложение за почивка (brighter/more saturated, same brightness as cinnamon). Applies to legend AND calendar cells."
  status: failed
  reason: "User reported: (1) Remove 'П' text from holiday legend swatch - never requested. (2) Лична почивка and Предложение за почивка too similar in color. Лична почивка needs brighter/more saturated color at same brightness level as cinnamon. Affects both legend and calendar."
  severity: major
  test: 7
  root_cause: "Legend.tsx line 8 renders 'П' inside cinnamon swatch. Vacation (#C68E17) and bridge (#EB9605) colors too similar — both amber/golden tones with similar saturation."
  artifacts:
    - path: "components/Legend.tsx"
      issue: "Line 8: 'П' text in holiday swatch"
    - path: "app/globals.css"
      issue: "Lines 21,36-37: --color-caramel/#C68E17 and --color-vacation/#C68E17 too close to --color-honey/#EB9605"
  missing:
    - "Remove 'П' text from Legend holiday swatch (empty colored square)"
    - "Change --color-vacation and --color-vacation-bg to brighter/more saturated values distinct from bridge"
    - "Vacation color brightness should match cinnamon (#B5651D) level"

- truth: "School holidays display only on weekdays, Лятна ваканция excluded, and bridge+school overlap cells split in two halves with respective colors"
  status: failed
  reason: "User reported: (1) School holidays should NOT show on Sat/Sun — weekdays only. (2) Skip Лятна ваканция (16 May – 14 Sep) entirely for every year. (3) Bridge day + school holiday overlap: split cell in two halves, each colored with its day type."
  severity: major
  test: 9
  root_cause: "schoolHolidays.ts getSchoolHolidayDates() uses eachDayOfInterval without weekday filter. No Лятна ваканция exclusion. MonthGrid has no split-cell rendering for overlaps."
  artifacts:
    - path: "lib/holidays/schoolHolidays.ts"
      issue: "getSchoolHolidayDates() includes weekends; getSchoolHolidays() doesn't exclude Лятна ваканция"
    - path: "components/MonthGrid.tsx"
      issue: "No split-cell rendering for bridge+school overlap"
  missing:
    - "Add getISODay() weekday filter (1-5 only) in getSchoolHolidayDates()"
    - "Filter out holidays with name 'Лятна ваканция' in getSchoolHolidays()"
    - "Add split-cell CSS (gradient or flex halves) for bridge+school overlap in MonthGrid"

- truth: "Weekend holidays shown on BOTH the weekend day (cinnamon + tooltip) AND the transferred Monday (cinnamon + tooltip with почивен ден). Do not hide holidays on weekends."
  status: failed
  reason: "User reported: changed mind — wants holidays displayed on both the weekend day AND the transferred Monday, both with cinnamon color and tooltips. Revert hiding holidays on weekends."
  severity: major
  test: 10
  root_cause: "MonthGrid.tsx lines 118-122: isWeekendHoliday check explicitly hides weekend holidays. showAsHoliday = isHoliday && !isWeekendHoliday excludes them from display."
  artifacts:
    - path: "components/MonthGrid.tsx"
      issue: "Lines 118-122: weekend holiday hiding logic"
  missing:
    - "Change line 120 to: const showAsHoliday = isHoliday (remove !isWeekendHoliday exclusion)"
    - "Tooltip already renders correctly for both cases — no DayTooltip changes needed"

- truth: "On mobile, holiday cells show a small exclamation mark icon at top-right corner. Tapping (click) the icon toggles tooltip visibility. No hover on mobile. Tooltip doesn't interfere with drag selection."
  status: failed
  reason: "User reported: changed mind — on mobile show small exclamation mark icon at top-right of holiday cells. Tapping (click, not hover) toggles tooltip. Keeps tooltip accessible without interfering with drag selection."
  severity: minor
  test: 11
  root_cause: "DayTooltip.tsx line 22: 'hidden lg:block' hides entire tooltip wrapper on mobile. No mobile-visible icon, no click handler, no stopPropagation."
  artifacts:
    - path: "components/DayTooltip.tsx"
      issue: "Line 22: hidden lg:block hides tooltip on mobile; no click-toggle or mobile icon"
  missing:
    - "Add mobile-visible icon (lg:hidden block) with '!' character"
    - "Add onClick handler with e.stopPropagation() to prevent drag trigger"
    - "Toggle tooltip visibility on click for mobile, keep hover for desktop"

- truth: "On mobile, all content sections (Легенда, Лична почивка, sidebars) match the same width as the calendar. Only header stays full-width. A wrapper constrains everything below the header to a consistent width."
  status: failed
  reason: "User reported: on mobile sidebars and cards don't match calendar width. Need wrapper so all sections except header fit the same width."
  severity: minor
  test: 12
  root_cause: "page.tsx mobile layout (lines 40-68) uses p-4 padding but no max-width wrapper to constrain all sections to same width as calendar."
  artifacts:
    - path: "app/page.tsx"
      issue: "Mobile layout lacks shared max-width wrapper for content sections"
  missing:
    - "Add max-w-[650px] mx-auto wrapper around mobile content below header"
