---
phase: 05.1-ux-infrastructure-feedback-loop
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/globals.css
  - app/layout.tsx
autonomous: true

must_haves:
  truths:
    - "All Coffee color tokens are available as Tailwind utility classes (bg-espresso, text-mocha, etc.)"
    - "Nunito font loads with cyrillic subset for Bulgarian text"
    - "Semantic color aliases exist for holiday types (bg-holiday, bg-bridge, bg-vacation)"
    - "Page body uses Foam background and Espresso text by default"
  artifacts:
    - path: "app/globals.css"
      provides: "Coffee theme tokens via @theme block and semantic aliases"
      contains: "--color-espresso"
    - path: "app/layout.tsx"
      provides: "Nunito font loader with cyrillic subset"
      contains: "Nunito"
  key_links:
    - from: "app/globals.css"
      to: "Tailwind utility generation"
      via: "@theme block"
      pattern: "@theme.*--color-espresso"
    - from: "app/layout.tsx"
      to: "app/globals.css"
      via: "CSS variable --font-nunito"
      pattern: "variable.*--font-nunito"
---

<objective>
Define all Coffee HTML Style Guide color tokens and typography in Tailwind v4's @theme system, and load the Nunito font with cyrillic support.

Purpose: Establishes the visual foundation that Plan 02 will consume when migrating component classes. Without tokens defined first, there are no utility classes to migrate to.
Output: globals.css with full Coffee @theme block, layout.tsx with Nunito font loader replacing Geist.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05.1-ux-infrastructure-feedback-loop/05.1-CONTEXT.md
@.planning/phases/05.1-ux-infrastructure-feedback-loop/05.1-RESEARCH.md
@app/globals.css
@app/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define Coffee theme tokens in globals.css</name>
  <files>app/globals.css</files>
  <action>
Replace the current globals.css content with Coffee theme tokens using Tailwind v4's @theme syntax.

1. Keep the `@import "tailwindcss";` at top.

2. Replace the `:root` CSS custom properties with Coffee defaults:
   - --background: #FAF8F5 (Foam)
   - --foreground: #2C1810 (Espresso)

3. Replace the existing `@theme inline` block with a comprehensive `@theme` block containing ALL Coffee tokens:

   **Base Colors:**
   - --color-espresso: #2C1810
   - --color-dark-roast: #3D251E
   - --color-mocha: #5D3A2E
   - --color-coffee: #6F4E37
   - --color-cappuccino: #8B6B5D
   - --color-latte: #C4A484
   - --color-oat-milk: #D4C4A8
   - --color-cream: #F5F0E8
   - --color-foam: #FAF8F5

   **Accent Colors:**
   - --color-caramel: #C68E17
   - --color-cinnamon: #B5651D
   - --color-honey: #EB9605

   **Semantic Colors:**
   - --color-success: #5D8A4E
   - --color-warning: #C68E17
   - --color-error: #B54D4D
   - --color-info: #5D7A8A

   **Semantic Calendar Aliases** (map to Coffee accents):
   - --color-holiday: #B5651D (Cinnamon)
   - --color-holiday-bg: #F5E6D8 (light Cinnamon tint for cell background)
   - --color-bridge: #EB9605 (Honey)
   - --color-bridge-bg: #FDF3DC (light Honey tint for cell background)
   - --color-vacation: #C68E17 (Caramel)
   - --color-vacation-bg: #F9EED4 (light Caramel tint for cell background)
   - --color-weekend-bg: #F5F0E8 (Cream)
   - --color-weekend-text: #8B6B5D (Cappuccino)
   - --color-today-ring: #C68E17 (Caramel)
   - --color-highlight: #D4C4A8 (Oat Milk)

   **Typography:**
   - --font-sans: 'Nunito', var(--font-nunito), ui-sans-serif, system-ui, sans-serif
   - --font-accent: 'Caveat', cursive

   **Border Radius:**
   - --radius-sm: 8px
   - --radius-md: 12px
   - --radius-lg: 16px
   - --radius-xl: 24px

   **Background/Foreground (preserve Tailwind integration):**
   - --color-background: var(--background)
   - --color-foreground: var(--foreground)

4. REMOVE the dark mode media query block entirely. Coffee theme does not define dark mode and dark mode is not a project requirement. Removing it prevents confusing visual conflicts.

5. Update the body styles:
   ```css
   body {
     background: var(--background);
     color: var(--foreground);
     font-family: 'Nunito', ui-sans-serif, system-ui, sans-serif;
   }
   ```

IMPORTANT: Use `@theme` (NOT `@theme inline`). The `inline` modifier prevents Tailwind from generating utility classes for custom tokens. We need `bg-espresso`, `text-mocha` etc. to work as utility classes.
  </action>
  <verify>
Run `npm run build` and confirm no CSS compilation errors. Then grep globals.css for key tokens:
- grep for "--color-espresso" in globals.css
- grep for "--color-holiday" in globals.css
- grep for "--font-sans" in globals.css
- Confirm @theme block (not @theme inline) is present
  </verify>
  <done>
globals.css contains full Coffee @theme block with all 9 base colors, 3 accents, 4 semantic colors, 10 calendar aliases, font definitions, and border radius tokens. Dark mode media query removed. Body uses Foam background and Nunito font.
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace Geist with Nunito font in layout.tsx</name>
  <files>app/layout.tsx</files>
  <action>
Replace the Geist font imports and configuration with Nunito:

1. Replace imports:
   - Remove: `import { Geist, Geist_Mono } from "next/font/google";`
   - Add: `import { Nunito } from "next/font/google";`

2. Replace font configuration:
   - Remove both `geistSans` and `geistMono` const declarations
   - Add:
     ```typescript
     const nunito = Nunito({
       variable: "--font-nunito",
       subsets: ["latin", "cyrillic"],
       weight: ["400", "600", "700"],
       display: "swap",
     });
     ```
   CRITICAL: Include "cyrillic" subset - the app is Bulgarian with Cyrillic UI text. Without this subset, Bulgarian text falls back to system fonts.

3. Update body className:
   - Replace `${geistSans.variable} ${geistMono.variable}` with `${nunito.variable}`
   - Keep `antialiased` class

4. Update themeColor in metadata:
   - Change from "#2563eb" (blue) to "#C68E17" (Caramel - Coffee accent)

5. Leave all other layout.tsx content UNCHANGED (AuthProvider, Toaster, NetworkStatus, ServiceWorkerRegistration).
  </action>
  <verify>
Run `npm run build` to confirm:
- No import errors (Nunito is available in next/font/google)
- No TypeScript errors
- Build completes successfully

Then verify:
- grep layout.tsx for "Nunito" (should find import + const)
- grep layout.tsx for "cyrillic" (must be present)
- grep layout.tsx for "Geist" (should NOT be found)
  </verify>
  <done>
layout.tsx loads Nunito with latin+cyrillic subsets, weights 400/600/700, swap display. Geist fonts completely removed. Theme color updated to Coffee Caramel. Build passes with zero errors.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` passes without errors
2. globals.css contains @theme block with all Coffee tokens (not @theme inline)
3. layout.tsx imports Nunito with cyrillic subset
4. No references to Geist fonts remain in layout.tsx
5. Tailwind utility classes like bg-espresso, text-mocha, bg-holiday are generated (verifiable in build output CSS)
</verification>

<success_criteria>
- Coffee color tokens defined in globals.css and available as Tailwind utility classes
- Nunito font with cyrillic subset loads via next/font/google
- Theme color metadata updated to Coffee Caramel (#C68E17)
- Build passes with zero errors
- No Geist font references remain
</success_criteria>

<output>
After completion, create `.planning/phases/05.1-ux-infrastructure-feedback-loop/05.1-01-SUMMARY.md`
</output>
