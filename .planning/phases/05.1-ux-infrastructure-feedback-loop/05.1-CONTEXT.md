# Phase 5.1: UX Infrastructure & Feedback Loop - Context

**Gathered:** 2026-02-06
**Status:** Ready for planning

<domain>
## Phase Boundary

Establish visual grounding (Coffee theme), browser automation (agent-browser), codebase indexing (ChunkHound), and a formal UX critique protocol. This is pure infrastructure — no new features, no behavioral changes, no UX improvements beyond what tooling integration strictly requires. Phase 6 cannot begin until this phase is complete and verified.

</domain>

<decisions>
## Implementation Decisions

### Coffee Theme Integration
- Full visual reskin — replace all current colors, fonts, spacing with Coffee tokens
- Semantic colors remapped to Coffee palette: Vacation=Caramel, Holidays=Cinnamon, Bridges=Honey
- Adopt Nunito font family (Coffee's default) replacing current system fonts
- Implement as Tailwind config extension — extend tailwind.config with Coffee tokens, use Tailwind classes throughout (fits existing codebase pattern)
- Document all inherited and overridden tokens
- No component behavior changes — visual only

Coffee theme reference: https://ggprompts.github.io/htmlstyleguides/styles/coffee.html

Key Coffee tokens:
- Colors: Espresso #2C1810, Dark Roast #3D251E, Mocha #5D3A2E, Coffee #6F4E37, Cappuccino #8B6B5D, Latte #C4A484, Oat Milk #D4C4A8, Cream #F5F0E8, Foam #FAF8F5
- Accents: Caramel #C68E17, Cinnamon #B5651D, Honey #EB9605
- Semantic: Success #5D8A4E, Warning #C68E17, Error #B54D4D, Info #5D7A8A
- Font: Nunito (sans-serif fallback), Caveat (accent/cursive)
- Spacing: 4px base unit, scale: xs(4) sm(8) md(16) lg(24) xl(32) 2xl(48) 3xl(64) 4xl(96)
- Border radius: sm(8px) md(12px) lg(16px) xl(24px)
- Shadows: espresso-based rgba(44,24,16) at varying opacities

### Browser Agent (agent-browser)
- Purpose: UX critique input — render the app so Claude can "see" the UI and provide observations
- Must render ALL distinct UI states: calendar, auth states (signed-in/anonymous), offline toast, migration modal, vacation summary, empty states
- Runs against dev server (localhost:3000) — live data, simpler setup
- Pre-commit hook: auto-run visual check before commits that touch UI files
- Install: `npm install -g agent-browser`
- Agent-browser uses ref-based selection (@e1, @e2) for deterministic element interaction
- Native Rust CLI with Node.js fallback (Playwright-based)

### ChunkHound Integration
- Dual integration: MCP server for Claude Code conversations + CLI for manual deep-dives
- Index full codebase (components/, contexts/, hooks/, lib/, app/, middleware, config)
- Role in UX critique: both component discovery AND theme consistency checks
- Auto re-index on file changes (watch mode or hook-based)
- Used to find which components render what browser agent sees
- Used to verify all components use Coffee theme tokens consistently

### UX Critique Protocol
- Trigger: mandatory before ANY UI code change — strict gate
- Output: structured markdown document saved to .planning/ with sections: Observations, Questions, Design System Violations
- Strictness: observations + questions allowed, but NEVER propose implementation or solutions
- Theme compliance: strict token validation — every color, font, spacing must match Coffee tokens, violations flagged
- No code changes during critique phase
- Critique is a prerequisite for all Phase 6 UX/UI work

### Claude's Discretion
- Exact agent-browser command sequences for each UI state capture
- ChunkHound configuration file specifics
- Pre-commit hook implementation details (husky vs simple git hook)
- Critique document template structure beyond required sections

</decisions>

<specifics>
## Specific Ideas

- Coffee HTML Style Guide is the enforced visual baseline: https://ggprompts.github.io/htmlstyleguides/styles/coffee.html
- agent-browser docs: https://agent-browser.dev/
- ChunkHound docs: https://chunkhound.github.io/
- Agent-browser produces compact text output (token-efficient for AI context)
- ChunkHound uses MCP (Model Context Protocol) for AI assistant integration
- ChunkHound's cAST algorithm provides structure-aware code chunking
- The critique loop is inspired by design review practices — observe first, question second, never prescribe

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 05.1-ux-infrastructure-feedback-loop*
*Context gathered: 2026-02-06*
